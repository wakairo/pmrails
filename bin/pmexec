#!/bin/sh

if [ "$#" -lt 1 ]; then
    echo "pmexec COMMAND [OPTIONS]"
    exit 1
fi

ver=latest
if test -e .ruby-version; then
    ver=$(cat .ruby-version | sed 's/^[^0-9]*\([0-9]\{1,\}\.[0-9]\{1,\}\.[0-9]\{1,\}\)[^0-9]*$/\1/g')
fi
podman run -it --rm -v "$PWD":/x -w /x -p 3000:3000 ruby:"$ver" sh -c "bundle config set --global path 'vendor/bundle' && $*"
